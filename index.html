<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>15 Jours de Positivit√© - Ai-Me | Au Pays de Marie</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.2/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&family=Quicksand:wght@500&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
  <style>
    body {
      font-family: 'Quicksand', 'Montserrat', Arial, sans-serif;
      background: linear-gradient(135deg, #fff7ed 0%, #fff1e0 100%);
      color: #402607;
    }
    .brand-footer {
      font-family: 'Montserrat', sans-serif;
      letter-spacing: 2px;
    }
    .day-btn-active, .day-btn:hover, .nav-btn-active {
      background: linear-gradient(90deg, #ffa94d 0%, #fd7e14 100%);
      color: #fff !important;
      box-shadow: 0 2px 8px rgba(253, 126, 20, 0.12);
    }
    .hue-anim { animation: hue 6s linear infinite; }
    @keyframes hue { 0% { filter: hue-rotate(0); } 100% { filter: hue-rotate(360deg); } }
    .scrollbar-hide::-webkit-scrollbar { display: none; }
    .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
    @media print {
      html, body, #content-main {
        overflow: visible !important;
        height: auto !important;
        max-height: none !important;
      }
      .scrollbar-hide, .overflow-y-auto {
        overflow: visible !important;
        max-height: none !important;
      }
    }
  </style>
</head>
<body class="min-h-screen flex flex-col">

  <!-- Header / Hero -->
  <header class="w-full text-center py-8 mb-2">
    <h1 class="text-3xl md:text-4xl font-montserrat hue-anim font-semibold mb-2 text-orange-600">15 Jours de Positivit√©</h1>
    <p class="text-lg max-w-2xl mx-auto text-orange-800">
      Cr√©ez votre rituel positif en 15 jours : intentions inspirantes, routines simples, gratitude et bien-√™tre au quotidien.<br>
      <span class="inline-block text-sm mt-3 bg-yellow-50 text-orange-500 px-4 py-1 rounded-full uppercase tracking-wider font-medium">
        Par "Ai-Me | Au Pays de Marie"
      </span>
    </p>
  </header>

  <main id="content-main" class="flex-1 max-w-3xl mx-auto px-2 md:px-0">
    <!-- Navigation Jours -->
    <nav class="flex flex-wrap justify-center gap-2 mb-6">
      <template id="nav-template"></template>
    </nav>

    <!-- Section principale du jour s√©lectionn√© -->
    <section id="day-content" class="rounded-2xl bg-white bg-opacity-70 shadow px-4 py-6 md:py-8 mb-6 transition-all duration-300">
      <!-- Le contenu du jour va √™tre inject√© ici par JS -->
    </section>

    <!-- Outils compl√©mentaires -->
    <section class="mb-10">
      <div class="flex flex-col md:flex-row gap-6 justify-center">
        <button id="btn-visualization" class="flex items-center gap-2 px-4 py-2 rounded-xl border border-orange-200 bg-orange-50 text-orange-700 hover:bg-orange-200 focus:outline-none mb-2 md:mb-0 transition">
          <i class="fa-solid fa-eye"></i> Visualisation Guid√©e
        </button>
        <button id="btn-breathing" class="flex items-center gap-2 px-4 py-2 rounded-xl border border-orange-200 bg-orange-50 text-orange-700 hover:bg-orange-200 focus:outline-none transition">
          <i class="fa-solid fa-heartbeat"></i> Coh√©rence Cardiaque
        </button>
        <button id="btn-mood" class="flex items-center gap-2 px-4 py-2 rounded-xl border border-orange-200 bg-orange-50 text-orange-700 hover:bg-orange-200 focus:outline-none transition">
          <i class="fa-solid fa-face-smile"></i> Suivi d'Humeur
        </button>
      </div>
    </section>

    <!-- Modals -->
    <div id="modal-bg" class="hidden fixed inset-0 bg-black bg-opacity-30 z-50"></div>

    <!-- Visualisation Modal -->
    <div id="modal-visualization" class="hidden fixed z-50 inset-0 flex items-center justify-center">
      <div class="bg-white rounded-2xl shadow-lg p-6 max-w-md w-full relative">
        <button onclick="closeModal()" class="absolute right-4 top-4 text-orange-400 hover:text-orange-600 text-lg focus:outline-none"><i class="fa fa-times"></i></button>
        <h2 class="text-xl font-bold text-orange-700 mb-1 flex items-center gap-2"><i class="fa-regular fa-eye"></i>Visualisation Guid√©e</h2>
        <p class="text-sm text-orange-900 mb-3">
          Installez-vous confortablement, fermez les yeux, et laissez-vous guider par cette visualisation positive :
        </p>
        <ol class="list-decimal list-inside space-y-2 text-orange-700">
          <li>Imaginez-vous vivre une journ√©e id√©ale, pleine de douceur et de r√©ussite.</li>
          <li>Visualisez vos relations, vos actions, vos sourires, la lumi√®re et la chaleur autour de vous.</li>
          <li>Ressentez la fiert√© et la paix d'avancer chaque jour vers le meilleur de vous-m√™me.</li>
        </ol>
        <p class="mt-3 text-xs">R√©p√©tez cette visualisation 1 √† 3 minutes, quotidiennement.</p>
      </div>
    </div>

    <!-- Coh√©rence cardiaque Modal -->
    <div id="modal-breathing" class="hidden fixed z-50 inset-0 flex items-center justify-center">
      <div class="bg-white rounded-2xl shadow-lg p-6 max-w-md w-full relative">
        <button onclick="closeModal()" class="absolute right-4 top-4 text-orange-400 hover:text-orange-600 text-lg focus:outline-none"><i class="fa fa-times"></i></button>
        <h2 class="text-xl font-bold text-orange-700 mb-2 flex items-center gap-2">
          <i class="fa-solid fa-heartbeat"></i>Coh√©rence Cardiaque
        </h2>
        <p class="text-sm text-orange-900 mb-3">Synchronisez votre respiration pour apaiser votre mental :<br><span class="font-normal">Inspirez 5s / Expirez 5s &mdash; 6 cycles par minute pendant 3 √† 5 minutes.</span></p>
        <div class="relative flex items-center justify-center w-full h-32 mb-2">
          <canvas id="breath-anim" width="180" height="120"></canvas>
        </div>
        <div id="breath-message" class="text-center font-semibold text-md text-orange-700 mb-1"></div>
        <button onclick="startBreathing()" id="start-breath" class="w-full mt-2 px-4 py-2 rounded-lg bg-orange-100 text-orange-700 border border-orange-200 hover:bg-orange-200 transition">D√©marrer l‚Äôexercice</button>
      </div>
    </div>

    <!-- Mood Tracker Modal -->
    <div id="modal-mood" class="hidden fixed z-50 inset-0 flex items-center justify-center">
      <div class="bg-white rounded-2xl shadow-lg p-6 max-w-md w-full relative">
        <button onclick="closeModal()" class="absolute right-4 top-4 text-orange-400 hover:text-orange-600 text-lg focus:outline-none"><i class="fa fa-times"></i></button>
        <h2 class="text-xl font-bold text-orange-700 mb-2 flex items-center gap-2"><i class="fa-solid fa-face-smile"></i>Suivi d'Humeur</h2>
        <p class="text-sm text-orange-900 mb-3">Comment vous sentez-vous aujourd‚Äôhui ?</p>
        <div class="flex justify-between gap-2 mb-4" id="mood-emojis">
          <button class="text-3xl px-2 focus:outline-none" onclick="saveMood(0)">üòî</button>
          <button class="text-3xl px-2 focus:outline-none" onclick="saveMood(1)">üòê</button>
          <button class="text-3xl px-2 focus:outline-none" onclick="saveMood(2)">üôÇ</button>
          <button class="text-3xl px-2 focus:outline-none" onclick="saveMood(3)">üòÉ</button>
          <button class="text-3xl px-2 focus:outline-none" onclick="saveMood(4)">ü§©</button>
        </div>
        <div style="height:180px;">
          <canvas id="mood-chart"></canvas>
        </div>
      </div>
    </div>

  </main>

  <footer class="w-full py-6 text-center mt-4 brand-footer text-orange-500 font-semibold text-lg tracking-wider bg-orange-50">
    Ai-Me | Au Pays de Marie
  </footer>

  <!-- Script -->
  <script>
    // --- Data ---
    const dayData = [
      {
        intention: "Aujourd‚Äôhui, je choisis d‚ÄôACCUEILLIR la joie, m√™me dans les petites choses.",
        routine_matin: "Buvez un grand verre d‚Äôeau au r√©veil, ouvrez la fen√™tre et faites trois grandes inspirations profondes.",
        affirmations: [
          "Je m√©rite le bonheur et la simplicit√©.",
          "Chaque matin est une promesse de renouveau.",
        ],
        gratitude: "Remerciez mentalement pour une chose qui vous fait sourire d√®s le matin (ex : un rayon de soleil, un oiseau qui chante, un message re√ßu‚Ä¶).",
        defibienetre: "Souriez √† trois personnes aujourd‚Äôhui (m√™me √† des inconnus) et observez l‚Äô√©nergie que cela cr√©e.",
        routine_soir: "√âteignez les √©crans 20 min avant le coucher, √©coutez une musique douce ou lisez une page inspirante."
      },
      {
        intention: "Aujourd‚Äôhui, je reste CURIEUX de tout et ouvert √† la nouveaut√©.",
        routine_matin: "Avant de vous lever, √©tirez-vous comme un chat puis prenez 2 minutes pour imaginer une chose nouvelle √† essayer aujourd‚Äôhui.",
        affirmations: [
          "J‚Äôaccueille le changement avec enthousiasme.",
          "Mon esprit est ouvert et vibrant."
        ],
        gratitude: "Notez une d√©couverte, une id√©e, ou une surprise du jour (aussi minime soit-elle).",
        defibienetre: "Testez une routine diff√©rente (petit-d√©jeuner, itin√©raire, musique‚Ä¶) pour dynamiser la journ√©e.",
        routine_soir: "Repensez √† une nouveaut√© de la journ√©e et f√©licitez-vous d‚Äôavoir os√© changer."
      },
      {
        intention: "Aujourd‚Äôhui, je m‚Äôaccorde la DOUCEUR, dans mes gestes et mes pens√©es.",
        routine_matin: "Prenez une douche consciente : sentez chaque goutte, respirez profond√©ment et d√©marrez la journ√©e avec calme.",
        affirmations: [
          "Je me traite avec bienveillance.",
          "La douceur am√©liore ma force int√©rieure."
        ],
        gratitude: "Remerciez-vous pour un soin, un effort, une attention envers vous-m√™me.",
        defibienetre: "Offrez-vous un auto-massage du visage ou des mains pendant une minute.",
        routine_soir: "Faites une respiration profonde, puis listez 3 moments doux de la journ√©e."
      },
      {
        intention: "Aujourd‚Äôhui, je m‚Äôengage √† RALENTIR et savourer l‚Äôinstant.",
        routine_matin: "Prenez votre petit-d√©jeuner sans distraction (sans t√©l√©phone). Mastiquez lentement, profitez de chaque bouch√©e.",
        affirmations: [
          "Je prends le temps d‚Äôappr√©cier chaque instant.",
          "Ralentir, c‚Äôest prendre soin de moi."
        ],
        gratitude: "D√©crivez un instant simple que vous avez savour√© aujourd‚Äôhui.",
        defibienetre: "Faites une promenade lente, en pleine conscience, en notant 5 choses que vous n‚Äôaviez jamais remarqu√©.",
        routine_soir: "√âcrivez ou m√©ditez pendant 3 minutes sur l‚Äôinstant qui vous a marqu√©."
      },
      {
        intention: "Aujourd‚Äôhui, je RAYONNE de gratitude.",
        routine_matin: "En vous regardant dans le miroir, dites √† voix haute : Merci la vie pour ce que je suis, ici et maintenant.",
        affirmations: [
          "Ma gratitude illumine ma journ√©e.",
          "J‚Äôattire du positif en √©tant reconnaissant."
        ],
        gratitude: "Notez ou partagez √† voix haute trois choses pour lesquelles vous ressentez de la gratitude.",
        defibienetre: "√âcrivez un petit mot ou envoyez un message de remerciement √† quelqu‚Äôun.",
        routine_soir: "Pensez √† ces 3 choses gratitude juste avant de dormir, et ressentez-les pleinement."
      },
      {
        intention: "Aujourd‚Äôhui, je fais CONFIANCE √† la vie et √† ses surprises.",
        routine_matin: "Listez trois qualit√©s ou capacit√©s sur lesquelles vous pouvez compter en toute situation.",
        affirmations: [
          "Je suis capable et confiant.",
          "Je laisse la vie me surprendre dans le bon sens."
        ],
        gratitude: "Remerciez pour un impr√©vu positif r√©cent, ou pour la capacit√© de rebondir apr√®s un impr√©vu.",
        defibienetre: "Tentez une action sans tout planifier : laissez place √† l‚Äôimprovisation.",
        routine_soir: "Repensez √† un moment o√π la confiance a port√© ses fruits aujourd‚Äôhui."
      },
      {
        intention: "Aujourd‚Äôhui, je m‚Äôengage √† √™tre GENTIL avec moi-m√™me et les autres.",
        routine_matin: "D√©finissez une attention bienveillante que vous pourrez offrir aujourd‚Äôhui, √† vous ou √† quelqu‚Äôun d‚Äôautre.",
        affirmations: [
          "La gentillesse est ma force.",
          "Je cultive la bienveillance √† chaque instant."
        ],
        gratitude: "C√©l√©brez la gentillesse re√ßue ou donn√©e aujourd‚Äôhui.",
        defibienetre: "Tendez la main spontan√©ment √† quelqu‚Äôun (aider, tenir une porte, dire bonjour‚Ä¶).",
        routine_soir: "Faites un scan int√©rieur et remerciez-vous pour chaque gentillesse accomplie."
      },
      {
        intention: "Aujourd‚Äôhui, je me concentre sur l‚Äô√âCOUTE de mes besoins.",
        routine_matin: "Au r√©veil, posez-vous la question : de quoi ai-je besoin aujourd‚Äôhui ? (repos, √©nergie, rire, nature‚Ä¶)",
        affirmations: [
          "Je respecte mes propres besoins.",
          "√âcouter mon corps, c‚Äôest me respecter."
        ],
        gratitude: "Remerciez-vous d‚Äôavoir pris en compte ne serait-ce qu‚Äôun petit besoin aujourd‚Äôhui.",
        defibienetre: "Consacrez 10 minutes √† faire seulement ce qui vous fait du bien.",
        routine_soir: "Notez ce que vous avez ressenti en √©coutant vos besoins."
      },
      {
        intention: "Aujourd‚Äôhui, je c√©l√®bre MES SUCC√àS, petits ou grands.",
        routine_matin: "Faites la liste de 3 choses accomplies la veille, m√™me minimes.",
        affirmations: [
          "Chaque √©tape m√©rite d‚Äô√™tre f√™t√©e.",
          "Je suis fier(e) de mes progr√®s."
        ],
        gratitude: "Soyez reconnaissant pour une victoire du jour.",
        defibienetre: "Offrez-vous un moment pour c√©l√©brer : musique favorite, danse, petite r√©compense‚Ä¶",
        routine_soir: "Gardez la trace de vos mini-succ√®s pour booster votre moral."
      },
      {
        intention: "Aujourd‚Äôhui, je privil√©gie l‚ÄôHARMONIE et la paix int√©rieure.",
        routine_matin: "M√©ditez (ou respirez) 2 minutes en visualisant un lieu paisible (plage, for√™t‚Ä¶).",
        affirmations: [
          "L‚Äôharmonie est une √©nergie que je choisis.",
          "Je reste centr√© malgr√© les turbulences."
        ],
        gratitude: "Remerciez pour un moment de calme dans votre journ√©e.",
        defibienetre: "√âcoutez une musique calme, ou restez 5 minutes sans rien faire.",
        routine_soir: "√âcrivez 2 choses qui ont favoris√© votre harmonie aujourd‚Äôhui."
      },
      {
        intention: "Aujourd‚Äôhui, je S√àME du positif autour de moi.",
        routine_matin: "D√©finissez une parole encourageante que vous pourriez offrir √† quelqu‚Äôun.",
        affirmations: [
          "Ma positivit√© est contagieuse.",
          "J‚Äôillumine la vie des autres."
        ],
        gratitude: "Remerciez pour l‚Äôimpact positif d‚Äôune rencontre ou d‚Äôun √©change.",
        defibienetre: "Partagez une ressource inspirante (livre, lien, vid√©o) avec un proche.",
        routine_soir: "Visualisez toutes les graines de positif sem√©es aujourd‚Äôhui."
      },
      {
        intention: "Aujourd‚Äôhui, j‚Äôaccueille la SIMPLICIT√â.",
        routine_matin: "√âtablissez une liste express de 3 priorit√©s r√©alistes pour la journ√©e.",
        affirmations: [
          "La simplicit√© rend ma vie plus belle.",
          "Je me lib√®re du superflu."
        ],
        gratitude: "Remerciez pour toutes les choses simples qui vous ont fait du bien aujourd‚Äôhui.",
        defibienetre: "D√©sencombrez un coin de votre espace, m√™me tr√®s petit.",
        routine_soir: "Terminez la journ√©e par une respiration apaisante, allong√©(e)."
      },
      {
        intention: "Aujourd‚Äôhui, je pratique la PATIENCE.",
        routine_matin: "R√©alisez une t√¢che du matin en pleine conscience, sans vous presser.",
        affirmations: [
          "La patience me rend plus fort(e).",
          "Je progresse √† mon rythme."
        ],
        gratitude: "Soyez reconnaissant pour un moment o√π votre patience a port√© ses fruits.",
        defibienetre: "Lorsque l‚Äôimpatience guette, prenez 3 inspirations longues et souriez.",
        routine_soir: "F√©licitez-vous pour vos moments de patience."
      },
      {
        intention: "Aujourd‚Äôhui, je cultive l‚ÄôOPTIMISME.",
        routine_matin: "Commencez la journ√©e par cette phrase : Quel est le meilleur qui puisse arriver aujourd‚Äôhui ?",
        affirmations: [
          "L‚Äôoptimisme m‚Äôouvre des portes.",
          "Je choisis le point de vue positif."
        ],
        gratitude: "Notez une chose qui vous donne espoir pour le futur.",
        defibienetre: "Faites une activit√© qui vous met instinctivement de bonne humeur.",
        routine_soir: "Laissez aller les pens√©es n√©gatives et notez au moins un moment positif."
      },
      {
        intention: "Aujourd‚Äôhui, je suis ACTEUR de mon bonheur.",
        routine_matin: "Visualisez votre journ√©e r√©ussie comme un petit film positif.",
        affirmations: [
          "Je cr√©e mon bonheur chaque jour.",
          "Je suis responsable de mon √©nergie."
        ],
        gratitude: "Remerciez pour le pouvoir que vous avez sur votre propre bonheur.",
        defibienetre: "√âcrivez une action (m√™me minime) que vous avez initi√©e pour vous-m√™me.",
        routine_soir: "Ressentez la satisfaction des initiatives prises aujourd‚Äôhui."
      },
      {
        intention: "Aujourd‚Äôhui, je m‚Äôautorise √† L√ÇCHER PRISE.",
        routine_matin: "Identifiez une pr√©occupation : dites-lui mentalement 'je pose √ßa, pour aujourd‚Äôhui'.",
        affirmations: [
          "Je rel√¢che le contr√¥le, je fais confiance.",
          "Le l√¢cher prise m‚Äôouvre √† la nouveaut√©."
        ],
        gratitude: "Soyez reconnaissant pour tout ce qui a √©t√© plus l√©ger ou inattendu.",
        defibienetre: "Pratiquez 5 minutes de relaxation ou de m√©ditation.",
        routine_soir: "Notez comment vous vous sentez apr√®s ce l√¢cher prise."
      }
    ];

    // -- Helper pour s√©lectionner un jour
    let currentDay = 0;

    function renderNav() {
      let navHtml = '';
      for (let i = 0; i < dayData.length; i++) {
        navHtml += `
          <button class="flex items-center justify-center w-10 h-10 rounded-full border border-orange-300 bg-white text-orange-400 text-lg font-bold focus:outline-none font-montserrat transition day-btn ${i === currentDay ? 'day-btn-active shadow' : ''}" onclick="selectDay(${i})" aria-label="Jour ${i+1}" id="btn-day-${i}">
            ${i+1}
          </button>
        `;
      }
      document.querySelector('nav').innerHTML = navHtml;
    }

    function renderDay(idx) {
      const d = dayData[idx];
      document.getElementById('day-content').innerHTML = `
        <div class="mb-4 flex justify-between items-start">
          <span class="inline-block px-4 py-2 rounded-xl bg-orange-100 text-orange-700 font-montserrat text-sm tracking-wider font-semibold shadow">Jour ${idx+1}</span>
          <span class="text-lg text-orange-400 font-semibold ml-2"><i class="fa-solid fa-sun"></i></span>
        </div>
        <h2 class="text-xl font-semibold text-orange-700 mb-2"><i class="fa-solid fa-star text-orange-400 opacity-80"></i> Intention du jour</h2>
        <blockquote class="border-l-4 border-orange-200 pl-4 italic mb-3 text-orange-900">${d.intention}</blockquote>

        <div class="mb-3">
          <h3 class="font-semibold text-orange-600 mb-1 flex items-center gap-2"><i class="fa-solid fa-cloud-sun"></i> Routine Matinale</h3>
          <p class="text-orange-900">${d.routine_matin}</p>
        </div>
        <div class="mb-3">
          <h3 class="font-semibold text-orange-600 mb-1 flex items-center gap-2"><i class="fa-solid fa-quote-left"></i> Affirmations Positives</h3>
          <ul class="list-disc list-inside space-y-1">
            ${d.affirmations.map(a => `<li>${a}</li>`).join('')}
          </ul>
        </div>
        <div class="mb-3">
          <h3 class="font-semibold text-orange-600 mb-1 flex items-center gap-2"><i class="fa-solid fa-leaf"></i> Exercice de gratitude</h3>
          <p class="text-orange-900">${d.gratitude}</p>
        </div>
        <div class="mb-3">
          <h3 class="font-semibold text-orange-600 mb-1 flex items-center gap-2"><i class="fa-solid fa-heart"></i> Petit d√©fi bien-√™tre</h3>
          <p class="text-orange-900">${d.defibienetre}</p>
        </div>
        <div>
          <h3 class="font-semibold text-orange-600 mb-1 flex items-center gap-2"><i class="fa-regular fa-moon"></i> Routine du soir apaisante</h3>
          <p class="text-orange-900">${d.routine_soir}</p>
        </div>
      `;
    }

    function selectDay(idx) {
      currentDay = idx;
      renderNav();
      renderDay(idx);
    }

    // --- Outils compl√©mentaires (modals) ---
    function closeModal() {
      document.getElementById('modal-bg').classList.add('hidden');
      document.getElementById('modal-visualization').classList.add('hidden');
      document.getElementById('modal-breathing').classList.add('hidden');
      document.getElementById('modal-mood').classList.add('hidden');
      // Stop breathing animation if exists
      if (window.breathingAnimRunning) {
        window.breathingAnimRunning = false;
        ctxBreath.clearRect(0,0,180,120);
        document.getElementById('breath-message').textContent = '';
      }
    }

    document.getElementById('btn-visualization').onclick = function() {
      document.getElementById('modal-bg').classList.remove('hidden');
      document.getElementById('modal-visualization').classList.remove('hidden');
    };
    document.getElementById('btn-breathing').onclick = function() {
      document.getElementById('modal-bg').classList.remove('hidden');
      document.getElementById('modal-breathing').classList.remove('hidden');
    };
    document.getElementById('btn-mood').onclick = function() {
      document.getElementById('modal-bg').classList.remove('hidden');
      document.getElementById('modal-mood').classList.remove('hidden');
      drawMoodChart();
    };
    document.getElementById('modal-bg').onclick = closeModal;

    // --- Coh√©rence cardiaque (respiration guid√©e) ---
    let ctxBreath = null;
    function startBreathing() {
      const cv = document.getElementById('breath-anim');
      ctxBreath = cv.getContext('2d');
      let phase = 0;
      let time = 0;
      let cycle = 0;
      window.breathingAnimRunning = true;

      function drawBreathBall(perc, msg) {
        ctxBreath.clearRect(0, 0, 180, 120);
        const r = 28 + 32 * perc;
        ctxBreath.beginPath();
        ctxBreath.arc(90, 60, r, 0, Math.PI * 2);
        ctxBreath.fillStyle = "#fd7e14";
        ctxBreath.globalAlpha = 0.33 + perc * 0.67;
        ctxBreath.fill();
        ctxBreath.globalAlpha = 1;
      }

      function breatheStep() {
        if (!window.breathingAnimRunning) return;
        let t = (time % 1000) / 1000;
        let cyclePos = Math.floor(time / 10000); // 10s each cycle
        let phaseT = (time % 10000) / 10000; // 0-1 over total 10s

        let perc, msg;
        if (phaseT < 0.5) {
          perc = phaseT / 0.5;
          msg = "Inspirez... (" + Math.ceil(5 - (phaseT*10)%5) + "s)";
        } else {
          perc = 1 - ((phaseT-0.5)/0.5);
          msg = "Expirez... (" + Math.ceil(5 - ((phaseT-0.5)*10)%5) + "s)";
        }
        drawBreathBall(perc, msg);
        document.getElementById('breath-message').textContent = msg;

        time += 50;
        if (time > 180000) { // 3 min = 180s = 180000ms. stop after 3min
          window.breathingAnimRunning = false;
          document.getElementById('breath-message').textContent = "Bravo ! Exercice termin√©.";
          return;
        }
        if (window.breathingAnimRunning) setTimeout(breatheStep, 50);
      }

      time = 0;
      window.breathingAnimRunning = false; // reset if running more than once
      setTimeout(() => {
        window.breathingAnimRunning = true;
        breatheStep();
      }, 300);
    }

    // -- Mood Tracker --
    function saveMood(level) {
      let moods = JSON.parse(localStorage.getItem('moodDays') || '[]');
      let today = (new Date()).toISOString().substr(0,10);
      // Update or push
      const idx = moods.findIndex(e => e.date === today);
      if (idx !== -1) moods[idx].level = level;
      else moods.push({date: today, level: level});
      localStorage.setItem('moodDays', JSON.stringify(moods));
      drawMoodChart();
    }
    function drawMoodChart() {
      const raw = localStorage.getItem('moodDays');
      let moodDays = raw ? JSON.parse(raw) : [];
      // Take last 15
      moodDays = moodDays.slice(-15);
      const el = document.getElementById('mood-chart');
      if (!el) return;

      if (window.chartMood) window.chartMood.destroy();
      window.chartMood = new Chart(el, {
        type: 'bar',
        data: {
          labels: moodDays.map(m=> m.date.slice(5)),
          datasets: [{
            label: 'Humeur',
            data: moodDays.map(m=> m.level),
            backgroundColor: [
              '#fd7e14','#ffa94d','#ffd59a','#a5ddaa','#00bc8c'
            ],
            borderWidth: 1
          }]
        },
        options: {
          scales: {
            y: { min: 0, max: 4, ticks: { stepSize: 1, callback:v=>['üòî','üòê','üôÇ','üòÉ','ü§©'][v] } }
          },
          plugins: {
            legend: { display: false }
          }
        }
      });
    }

    // --- Init page ---
    document.addEventListener('DOMContentLoaded', function() {
      renderNav();
      renderDay(currentDay);
    });
  </script>
</body>
</html>
